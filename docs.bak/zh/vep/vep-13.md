# VEP 13: 超级节点奖励计算和发放规则

## 奖励说明
Vite每年会增发不超过3%的vite代币用于超级节点奖励。以10亿发行量为例，第一年超级节点每出一个快照块产生的奖励为`0.951293759512937595 vite`。

超级节点奖励每个周期（即1152轮，一天）计算一次，这个周期最后一轮（即75s）排名前100名（包含第100名）的超级节点可以获得奖励。

Vite通过增发的方式来发放超级节点奖励，增发后官方会销毁等量的代币，来保证预主网vite总流通量保持不变。

## 奖励计算规则

超级节点奖励包含按块奖励和按票奖励两部分：

按块奖励：每个块奖励的50%会作为按块奖励直接给予出块者。

按票奖励：每个块奖励的50%会根据出块者在这个周期内的出块率和投票数占比奖励给这个周期最后一轮前100名出块者。

奖励计算公式为：

$$Q = \frac{l}{m}*\frac{V}{W}*X*R*0.5 + l*R*0.5$$

* `Q`: 某个节点一个周期内的奖励
* `l`: 该节点在一个周期内的实际出块数
* `m`: 该节点在一个周期内的应出块数，如果某一轮所有节点都没有出块，那么该轮所有节点的应出块数为0，即不计入总的应出块数
* `X`: 所有节点在一个周期内的实际出块数
* `W`: 一个周期最后一轮前100名节点获得的总投票数，和前100名的注册抵押金额（每个节点注册时抵押100w vite）之和
* `V`: 该节点在一个周期的最后一轮获得的投票数和这个节点的注册抵押金额之和
* `R`: 每个块的奖励，第一年固定为：`0.951293759512937595 vite`

例如：

某个周期，共2个出块节点S1和S2，这个周期最后一轮时S1和S2都在前100名，此时S1的投票数为20w vite，S2的投票数为30w vite，。

第一轮S1应出块3，实际出块1，S2应出块3，实际出块2；

第二轮S1应出块3，实际出块2，S2应出块3，实际出块3；

第三轮开始S1和S2都没有出块。

那么S1在这个周期的奖励计算公式为

$$Q = \frac{1+2}{3+3}*\frac{200000+1000000}{200000+1000000+300000+1000000}*(1+2+2+3)*0.951293759512937595*0.5+(1+2)*0.951293759512937595*0.5$$

S2在这个周期的奖励计算公式为

$$Q = \frac{2+3}{3+3}*\frac{300000+1000000}{200000+1000000+300000+1000000}*(1+2+2+3)*0.951293759512937595*0.5+(2+3)*0.951293759512937595*0.5$$

## 奖励提取规则

* 超级节点的注册者主动提取奖励；
* 只能提取*48*轮（大约一小时）以前的奖励；
* 提取时按周期（天）提取；
* 不足一个周期的奖励无法提取，例如注册后的第一个周期、取消注册前的最后一个周期没有奖励。

## 奖励发放流程

提取超级节点奖励时，

* 首先由超级节点的注册者向共识信息合约发起一笔提取奖励的请求交易，指定提取奖励的超级节点名称和奖励收取地址（通过官方钱包提取奖励时默认提取到注册地址）；
* 共识信息合约在响应交易中计算可提取奖励金额，并向铸币合约发起一笔增发请求交易，增发的代币为vite，增发数量为可提取奖励金额，增发的代币收取地址为奖励收取地址；
* 铸币合约在响应交易中对vite进行增发，并将增发的数量通过一笔转账交易转给奖励收取地址；
* 奖励收取地址接收奖励的vite。

因此，vite代币为可增发代币，代币所有者为共识信息合约。只有超级节点奖励一种方式可以增发vite。
